@page "/admin/article/create"
@model FindingHealthcareSystem.Pages.Admin.Article.CreateModel
@{
}
<!--------------------------------------------------------------------------------------------------------!>
<!--                                        CREATE ARTICLE (ADMIN)                                      --!>
<!--------------------------------------------------------------------------------------------------------!>
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet" /> <!--this for editing content of news-->
<link rel="stylesheet" href="~/css/detailArticle.css" />

<div class="container mt-10">
    <div class="col-12">
        <div class="article-form-container">

            <!-- Article Form -->
            <form id="articleForm" method="post" enctype="multipart/form-data">
                <div class="row">
                    <div class="col-md-8">
                        <div class="form-group">
                            <label for="articleTitle" class="form-label">Tiêu đề</label>
                            <input type="text" class="form-control" id="articleTitle" placeholder="Nhập tiêu đề" asp-for="Article.Title">
                        </div>
                    </div>
                     <div class="col-md-4">
                         <div class="form-group">
                             <label for="articleCategory" class="form-label">Thể loại</label>
                             <select class="form-select" id="articleCategory" asp-for="Article.CategoryId">
                                @foreach (var article in Model.Articles)
                                {
                                    <option value="@article.CategoryId">@article.CategoryName</option>
                                }
                             </select>
                         </div>
                     </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Nội dung</label>
                    <div class="editor-container">
                        <div id="editor"></div>
                        <textarea id="contentField" asp-for="Article.Content" class="d-none"></textarea>
                    </div>
                </div>

@*                 <div class="form-group">
                    <label class="form-label">Hình ảnh</label>
                    <div class="image-upload-area" id="imageUpload">
                        <div class="image-upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <h5>Up ảnh đây nè</h5>
                        <p class="text-muted">Định dạng: JPG, JPEG, PNG (Max: 5MB)</p>
                        <input type="file" id="imageInput" asp-for="ImageFiles" multiple accept="image/*" class="d-none">
                    </div>

                    <div class="image-preview-container" id="imagePreview">
                        <!-- Ảnh preview sẽ hiển thị ở đây -->
                    </div>
                </div> *@

                <div class="action-buttons">
                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary">Publish</button>
                    </div>
                    <button type="button" class="btn btn-outline-danger">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Initialize Quill editor
        var quill = new Quill('#editor', {
            modules: {
                toolbar: [
                    [{ 'header': [1, 2, 3, 4, 5, 6, false] }],
                    ['bold', 'italic', 'underline', 'strike'],
                    [{ 'color': [] }, { 'background': [] }],
                    [{ 'list': 'ordered' }, { 'list': 'bullet' }],
                    ['blockquote', 'code-block'],
                    ['link', 'image'],
                    [{ 'align': [] }],
                    ['clean']
                ]
            },
            placeholder: 'Nhớ viết content nheng...',
            theme: 'snow'
        });

        // Lấy nội dung từ Quill vào input hidden khi submit
        document.getElementById('articleForm').addEventListener('submit', function () {
            document.getElementById('contentField').value = quill.root.innerHTML;
        });

        // Image Upload Functionality
        const imageUpload = document.getElementById('imageUpload');
        const imageInput = document.getElementById('imageInput');
        const imagePreview = document.getElementById('imagePreview');

        imageUpload.addEventListener('click', function () {
            imageInput.click();
        });

        imageInput.addEventListener('change', function () {
            imagePreview.innerHTML = ''; // Xóa preview cũ
            Array.from(imageInput.files).forEach(file => {
                const reader = new FileReader();
                reader.onload = function (e) {
                    const imgElement = document.createElement('img');
                    imgElement.src = e.target.result;
                    imgElement.classList.add('image-preview-item');
                    imagePreview.appendChild(imgElement);
                };
                reader.readAsDataURL(file);
            });
        });
    });
</script>
